# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ IMPROVEMENT_PLAN

**–î–∞—Ç–∞:** 2026-01-25  
**–í–µ—Ä—Å–∏—è:** v1.1.1 ‚Üí v1.2.0 (planned)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞

---

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### ‚úÖ –ó–∞–¥–∞—á–∞ 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è `/api/v1/api/v1`

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö frontend API —Ñ–∞–π–ª–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `/v1/` –≤ –Ω–∞—á–∞–ª–µ –ø—É—Ç–∏, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é `/api/v1/api/v1`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ `frontend/src/api/users.ts` - —É–±—Ä–∞–Ω `/v1/` –∏–∑ –≤—Å–µ—Ö –ø—É—Ç–µ–π
- ‚úÖ `frontend/src/api/business.ts` - —É–±—Ä–∞–Ω `/v1/business/` –∏–∑ –≤—Å–µ—Ö –ø—É—Ç–µ–π
- ‚úÖ `frontend/src/api/analytics.ts` - —É–±—Ä–∞–Ω `/v1/` –∏–∑ –≤—Å–µ—Ö –ø—É—Ç–µ–π
- ‚úÖ `frontend/src/api/sync.ts` - —É–±—Ä–∞–Ω `/v1/` –∏–∑ –≤—Å–µ—Ö –ø—É—Ç–µ–π
- ‚úÖ `frontend/scripts/check-api-prefix.js` - —É–ª—É—á—à–µ–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ–≥–æ `src/`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- ‚úÖ `npm run check:api-prefix` –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 2: Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

1. **POST `/api/v1/mapping/button-matrices/{matrix_id}/items/batch`**
   - –ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
   - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–≤—Å–µ –∏–ª–∏ –Ω–∏—á–µ–≥–æ)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

2. **POST `/api/v1/mapping/button-matrices/{matrix_id}/clone`**
   - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —Å–æ –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
   - –û–ø—Ü–∏—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã
   - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞–º

**–§–∞–π–ª—ã:**
- ‚úÖ `backend/app/api/v1/mapping.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã endpoints
- ‚úÖ `backend/app/schemas/business.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ö–µ–º—ã
- ‚úÖ `frontend/src/api/mapping.ts` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

1. **GET `/api/v1/analytics/sales/summary`**
   - –°–≤–æ–¥–∫–∞ –ø—Ä–æ–¥–∞–∂ (–æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
   - –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç view `vw_tx_cogs`

2. **GET `/api/v1/analytics/sales/margin`**
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Ä–∂–∏ –º–µ–∂–¥—É –ø–µ—Ä–∏–æ–¥–∞–º–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –†–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞

3. **GET `/api/v1/analytics/owner-report/daily`**
   - –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –¥–Ω—è–º
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–Ω—è–º —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `vw_owner_report_daily` —Å fallback –Ω–∞ `vw_kpi_daily`

4. **GET `/api/v1/analytics/owner-report/issues`**
   - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º –∏ –∞–ª–µ—Ä—Ç–æ–≤
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å—Ç–∞—Ç–∫–∏ (–Ω–∏–∑–∫–∏–π stock)
   - –ù–∏–∑–∫–∞—è –º–∞—Ä–∂–∞ (< 30%)
   - –û—à–∏–±–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–∏–∑ `sync_runs`)

**–§–∞–π–ª—ã:**
- ‚úÖ `backend/app/api/v1/analytics.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã endpoints

---

### ‚úÖ –ó–∞–¥–∞—á–∞ 4: –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

1. **GET `/api/v1/expenses/analytics`**
   - –ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –¥–Ω—è–º
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
   - –¢—Ä–µ–Ω–¥—ã —Ä–∞—Å—Ö–æ–¥–æ–≤ (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–∏–æ–¥–æ–º)
   - –°–≤–æ–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

2. **GET `/api/v1/expenses/categories`**
   - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (—Å—É–º–º–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Å—Ä–µ–¥–Ω–µ–µ, –º–∏–Ω/–º–∞–∫—Å)
   - –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–§–∞–π–ª—ã:**
- ‚úÖ `backend/app/api/v1/expenses.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã endpoints

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### Backend
- **–ù–æ–≤—ã—Ö endpoints:** 8
- **–ù–æ–≤—ã—Ö —Å—Ö–µ–º:** 3
- **–ò–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:** 3
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~600

### Frontend
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:** 5
- **–ù–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤:** 2
- **–£–ª—É—á—à–µ–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤:** 1

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
- ‚úÖ –í—Å–µ endpoints –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ä–æ—É—Ç–µ—Ä–∞—Ö
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ –í—Å–µ —Å—Ö–µ–º—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- ‚úÖ API prefix check –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Playwright –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã endpoints –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend
1. `backend/app/api/v1/mapping.py`
   - –î–æ–±–∞–≤–ª–µ–Ω `batch_update_button_matrix_items`
   - –î–æ–±–∞–≤–ª–µ–Ω `clone_button_matrix`

2. `backend/app/api/v1/analytics.py`
   - –î–æ–±–∞–≤–ª–µ–Ω `get_sales_summary`
   - –î–æ–±–∞–≤–ª–µ–Ω `get_sales_margin`
   - –î–æ–±–∞–≤–ª–µ–Ω `get_owner_report_daily`
   - –î–æ–±–∞–≤–ª–µ–Ω `get_owner_report_issues`

3. `backend/app/api/v1/expenses.py`
   - –î–æ–±–∞–≤–ª–µ–Ω `get_expenses_analytics`
   - –î–æ–±–∞–≤–ª–µ–Ω `get_expenses_categories`

4. `backend/app/schemas/business.py`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ `ButtonMatrixItemBatchRequest`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ `ButtonMatrixItemBatchResponse`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ `ButtonMatrixCloneRequest`

### Frontend
1. `frontend/src/api/users.ts` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏
2. `frontend/src/api/business.ts` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏
3. `frontend/src/api/analytics.ts` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏
4. `frontend/src/api/sync.ts` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏
5. `frontend/src/api/mapping.ts` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã batch –∏ clone
6. `frontend/scripts/check-api-prefix.js` - —É–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   - –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É `vending-prod` –ø–æ SSH
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö endpoints
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Playwright

2. **–ö–æ–º–º–∏—Ç:**
   - –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –∫–æ–º–º–∏—Ç
   - –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ó–∞–ø—Ä–æ—Å–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

---

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ views –∏ —Ç–∞–±–ª–∏—Ü—ã –ë–î
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –í—Å–µ endpoints —Ç—Ä–µ–±—É—é—Ç owner-—Ä–æ–ª–∏ (–∫—Ä–æ–º–µ –ø—É–±–ª–∏—á–Ω—ã—Ö)

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –∫–æ–º–º–∏—Ç—É!** ‚úÖ

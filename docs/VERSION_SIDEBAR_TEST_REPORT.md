# Отчёт: тесты версии в сайдбаре и визуальная проверка

**Дата:** 2026-01-25

---

## Что сделано

### 1. Тесты через Chrome DevTools MCP

- Открыт **https://admin.b2broundtable.ru**
- Сделан snapshot и full‑page screenshot страницы логина
- Попытка перейти на `/settings` с имитацией auth (localStorage) — редирект на логин (ожидаемо, т.к. токен невалидный)

### 2. Результаты проверки

| Проверка | Результат |
|----------|-----------|
| Логин: отображается ли версия | ✅ Да, внизу: «Версия 1.0.0 • © 2026 Vending Admin» |
| Прод отдаёт билд с 1.1.1 | ❌ Нет, на проде **1.0.0** |
| Локальная сборка | ✅ В бандле есть `1.1.1` |
| Версия в сайдбаре (код) | ✅ Реализована в `AppLayout`, блок под меню |

**Вывод:** на проде развёрнут **старый** фронтенд (1.0.0). Ветка `test/version-sidebar` с 1.1.1 и правками сайдбара либо не задеплоена, либо отдаётся старый кэш.

### 3. Правки в `AppLayout`

Чтобы версия **всегда была видна** внизу сайдбара:

1. **Версия вынесена из скролла**
   - Раньше: меню + версия в одном скроллируемом блоке → при длинном меню версия уезжала вниз.
   - Сейчас: меню в `overflow: auto`, блок версии — **отдельно внизу** сайдбара, `flexShrink: 0`. Версия закреплена внизу и не скроллится.

2. **Сохранено**
   - Версия сразу под разделом «Настройки» (визуально внизу списка пунктов).
   - Отображение только при **развёрнутом** сайдбаре (`!collapsed`).

### 4. Скриншоты

- `.playwright-mcp/version-sidebar-test-fullpage.png` — логин (видна «Версия 1.0.0»).
- `.playwright-mcp/version-test-login-after-reload.png` — логин после перезагрузки (то же).

---

## Что нужно сделать, чтобы увидеть версию на проде

1. **Задеплоить актуальный фронт с `test/version-sidebar`**
   - На сервере: `git fetch` → `git checkout test/version-sidebar` → `git pull`
   - В `frontend`: `npm install` → `npm run build`
   - Скопировать `dist/*` в `/var/www/vending-admin/`
   - `sudo systemctl reload nginx`

2. **Жёсткая перезагрузка в браузере**
   - `Ctrl+Shift+R` (Windows) или `Cmd+Shift+R` (Mac), либо режим инкогнито.

3. **Проверить**
   - Сайдбар **развёрнут** (не свёрнут).
   - Открыта любая страница с сайдбаром (например, «Настройки»).
   - Внизу сайдбара: **v1.1.1** и дата релиза.

---

## Итог

- Логика версии в сайдбаре и на логине реализована и в сборке есть.
- На проде пока **старый билд** (1.0.0), поэтому версия в сайдбаре и актуальная «1.1.1» на логине не видны.
- После деплоя `test/version-sidebar` и сброса кэша версия в сайдбаре и на логине будет отображаться корректно.

# –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö endpoints

**–î–∞—Ç–∞:** 2026-01-25  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

---

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

1. **–°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥–∞:**
   - ‚úÖ –í—Å–µ Python —Ñ–∞–π–ª—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
   - ‚úÖ –í—Å–µ TypeScript —Ñ–∞–π–ª—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
   - ‚úÖ API prefix check –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
   - ‚úÖ –õ–∏–Ω—Ç–µ—Ä –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –æ—à–∏–±–æ–∫

2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞:**
   - ‚úÖ –í—Å–µ endpoints –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ä–æ—É—Ç–µ—Ä–∞—Ö
   - ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
   - ‚úÖ –í—Å–µ —Å—Ö–µ–º—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
   - ‚úÖ Frontend –º–µ—Ç–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã

---

## üß™ –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 1: –î–µ–ø–ª–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–µ–ø–ª–æ—è:**

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ vending-prod
cd /opt/vending-admin-v2
git pull origin main  # –ü–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞
cd backend
docker compose -f docker-compose.prod.yml up -d --build app
cd ../frontend
npm ci && npm run build
```

### –≠—Ç–∞–ø 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö endpoints

**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–ª–æ–º–∞–ª–æ—Å—å

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/api/v1/analytics/overview`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/api/v1/mapping/button-matrices`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/api/v1/expenses/`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ endpoints

### –≠—Ç–∞–ø 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö endpoints

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç:** `test_new_endpoints.sh`

**–ù–æ–≤—ã–µ endpoints –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

1. **GET `/api/v1/analytics/sales/summary`**
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `from_date`, `to_date`, `location_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏

2. **GET `/api/v1/analytics/sales/margin`**
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `from_date`, `to_date`, `location_id`, `compare_from_date`, `compare_to_date` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º

3. **GET `/api/v1/analytics/owner-report/daily`**
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `period_start`, `period_end`, `location_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ—Ç—á–µ—Ç–æ–º –ø–æ –¥–Ω—è–º

4. **GET `/api/v1/analytics/owner-report/issues`**
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `location_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å–æ —Å–ø–∏—Å–∫–æ–º –ø—Ä–æ–±–ª–µ–º –∏ –∞–ª–µ—Ä—Ç–æ–≤

5. **GET `/api/v1/expenses/analytics`**
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `from_date`, `to_date`, `location_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π —Ä–∞—Å—Ö–æ–¥–æ–≤

6. **GET `/api/v1/expenses/categories`**
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `from_date`, `to_date`, `location_id` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π

7. **POST `/api/v1/mapping/button-matrices/{matrix_id}/items/batch`**
   - –¢–µ–ª–æ: `{ "items": [...] }`
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö/–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

8. **POST `/api/v1/mapping/button-matrices/{matrix_id}/clone`**
   - –¢–µ–ª–æ: `{ "name": "...", "description": "...", "vendista_term_ids": [...] }`
   - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: JSON —Å –Ω–æ–≤–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π

### –≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Playwright

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ UI

1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ UI (–µ—Å–ª–∏ –æ–Ω–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üìù –ß–µ–∫–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Backend endpoints

- [ ] GET `/api/v1/analytics/sales/summary` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] GET `/api/v1/analytics/sales/margin` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] GET `/api/v1/analytics/owner-report/daily` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] GET `/api/v1/analytics/owner-report/issues` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] GET `/api/v1/expenses/analytics` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] GET `/api/v1/expenses/categories` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] POST `/api/v1/mapping/button-matrices/{id}/items/batch` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] POST `/api/v1/mapping/button-matrices/{id}/clone` - —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ endpoints (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏)

- [ ] GET `/api/v1/analytics/overview` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] GET `/api/v1/mapping/button-matrices` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] GET `/api/v1/expenses/` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –î—Ä—É–≥–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ endpoints - —Ä–∞–±–æ—Ç–∞—é—Ç

### Frontend

- [ ] API prefix check –ø—Ä–æ—Ö–æ–¥–∏—Ç
- [ ] –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è `/api/v1/api/v1`
- [ ] –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤ `mapping.ts` —Ä–∞–±–æ—Ç–∞—é—Ç

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- [ ] –í—Å–µ endpoints –¥–æ—Å—Ç—É–ø–Ω—ã

---

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä DevTools –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
# –ò–ª–∏ —á–µ—Ä–µ–∑ API:
curl -X POST https://roman.razdobreev.fvds.ru/api/v1/auth/telegram_oauth \
  -H "Content-Type: application/json" \
  -d '{"init_data": "..."}'
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /opt/vending-admin-v2
./test_new_endpoints.sh <JWT_TOKEN>
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. –í—Å–µ –Ω–æ–≤—ã–µ endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
2. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ endpoints –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
3. –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. API prefix check –ø—Ä–æ—Ö–æ–¥–∏—Ç
5. Playwright —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)

---

**–ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** ‚úÖ
